<!DOCTYPE html>
<html>
<head>
    <title>HR</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <script type="text/javascript" src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>
    <script>
        function ToJson() {
            var $txt = $("#text");
            var x = $txt.val();
            x = x.split("\n");
            for (var i in x) {
                x[i] = decodeURI(encodeURI(x[i]).replace(/%09/g, '+')).split('+');
            }
            if (x.length < 2)throw new error();
            var data = {};
            for (var i in x) {
                if (x[i] && x[i][0] && [x[i][1]]) {
                    if (typeof data[x[i][0]] == 'undefined') {
                        data[x[i][0]] = {}
                    }
                    if (typeof data[x[i][0]][x[i][1]] == 'undefined') {
                        data[x[i][0]][x[i][1]] = {}
                    }
                    if (typeof data[x[i][0]][x[i][1]][x[i][2]] == 'undefined') {
                        data[x[i][0]][x[i][1]][x[i][2]] = []
                    }
                    data[x[i][0]][x[i][1]][x[i][2]].push(x[i][3]);
                }
            }
            console.log(data);
            $txt.val(JSON.stringify(data));
            alert("转换成功!\n请从文本框全选复制进对应的js文件");
            try {

            }
            catch (err) {
                alert("文本格式不正确!\n请从excel文档中直接粘贴过来!\n并确认当前为最新版chrome浏览器");
            }
        }

    </script>
    <style>
        input{
            height: 35px;
            display: block;
            margin: 0 auto;
            width: 130px;
        }
        textarea{
            width:100%;
            height:500px;
            margin: 0px;
            padding: 0px;
        }
    </style>
</head>
<body>
<div id="base">
    <textarea id="text"></textarea>
    <input type="button" onclick="ToJson()" value="转json">
</div>
</body>
</html>
